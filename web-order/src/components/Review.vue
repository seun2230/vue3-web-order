<template>
  <div class="container">
    <div class="inner">
      <p> * ê³ ê°ë‹˜ì˜ ì†”ì§í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”. </p>
      <div class="inner-form">
        <el-form 
          ref="form" 
          :model="form"
          label-position="top"
          label-width="100px">
          <el-form-item 
            label="ì œëª©"
            placeholder="ìµœì†Œ 15ì ë‚´ì™¸ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.">
            <el-input 
              v-model="form.title" /> 
          </el-form-item> 
          <el-form-item 
            label="ë©”ë‰´ ì´ë¦„">
            <el-select
              v-model="form.menu" 
              placeholder="ì˜¤ëŠ˜ì˜ ë©”ë‰´ëŠ”?">
              <el-option
                v-for="food in foods"
                :key="food.food_id"
                :label="food.food_name"
                :value="food.food_id" />
            </el-select>
          </el-form-item>
          <el-form-item label="í‰ì ">
            <el-select 
              v-model="form.ratings"
              width="30px"
              placeholder="ìŒì‹/ê°€ê²©?" >
              <el-option 
                label="ğŸ˜: ì•„ì£¼ ë§Œì¡±í•´ìš”" 
                value="5" />         
              <el-option 
                label="ğŸ˜Š: ë§Œì¡±í•´ìš” " 
                value="4" />
              <el-option 
                label="ğŸ™„: ë³´í†µì´ì—ìš” " 
                value="3" />
              <el-option 
                label="ğŸ™: ê·¸ëƒ¥ ê·¸ë˜ìš” " 
                value="2" />
              <el-option 
                label="ğŸ˜¤: ë³„ë¡œì—ìš”" 
                value="1" />
            </el-select>
          </el-form-item>
          <el-form-item label="í‚¤ì›Œë“œ ë“±ë¡(ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)" />
          <el-carousel height="320px" :interval="8000" arrow="always">
            <el-carousel-item  >
               <h3>ë©”ë‰´</h3>
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword1" value="ì¹˜í‚¨ì´ ë§›ìˆì–´ìš”" /> 
              <label 
                for="keyword1">ì¹˜í‚¨ì´ ë§›ìˆì–´ìš”</label>
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword2" value="ë¶ˆê³ ê¸°ê°€ ë§›ìˆì–´ìš”" /> 
              <label 
                for="keyword2">ë¶ˆê³ ê¸°ê°€ ë§›ìˆì–´ìš”</label>
                <input 
              type="checkbox" 
              v-model="keywords" id="keyword3" value="ê¹€ì¹˜ì „ì´ ë§›ìˆì–´ìš”" /> 
              <label 
                for="keyword3">ê¹€ì¹˜ì „ì´ ë§›ìˆì–´ìš”</label>
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword4" value="ëŒ€ê¸°ì—´ì´ ì§§ì•„ìš”"/> 
              <label 
                for="keyword4">ëŒ€ê¸°ì—´ ì§§ì•„ìš”</label>
             <input 
              type="checkbox" 
              v-model="keywords" id="keyword5" value="ê°€ì„±ë¹„ê°€ ë†’ì•„ìš”"/> 
              <label for="keyword5">ê°€ì„±ë¹„ê°€ ë†’ì•„ìš”</label> 
             <input 
              type="checkbox" 
              v-model="keywords" id="keyword6" value="ì£¼ë¬¸ ê°„í¸í•´ìš”"/>
              <label for="keyword6">ğŸ›’ì£¼ë¬¸ ê°„í¸í•´ìš”</label> 
            </el-carousel-item>
            <el-carousel-item>
              <h3>ë§¤ì¥</h3>
              <input 
                type="checkbox" 
                v-model="keywords" id="keyword7" value="ì‚¬ì¥ë‹˜ì´ ì¹œì ˆí•´ìš”"/>
              <label for="keyword7">ğŸ‘©â€ğŸ³ì‚¬ì¥ë‹˜ ì¹œì ˆí•´ìš”"</label> 
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword8" value="ë·°ê°€ ì¢‹ì•„ìš”"/>
              <label for="keyword8">ğŸ ë·°ê°€ ì¢‹ì•„ìš”</label> <br />
               <input 
              type="checkbox" 
              v-model="keywords" id="keyword9" value="ë¶„ìœ„ê¸°ê°€ ì¡°ìš©í•´ìš”"/>
              <label for="keyword9">ë¶„ìœ„ê¸°ê°€ ì¡°ìš©í•´ìš”</label> 
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword10" value="ë§¤ì¥ì´ ì²­ê²°í•´ìš”"/>
              <label for="keyword10">ë§¤ì¥ì´ ì²­ê²°í•´ìš”</label>
             <input 
              type="checkbox" 
              v-model="keywords" id="keyword11" value="ì£¼ì°¨ ì‹œì„¤ì´ ê´œì°®ì•„ìš”"/>
              <label for="keywor11">ğŸš—ì£¼ì°¨ í¸ë¦¬í•´ìš”</label> 
              <input 
              type="checkbox" 
              v-model="keywords" id="keyword12" value="í˜¼ì ì™€ë„ ì¢‹ì•„ìš”"/>
              <label for="keyword12">í˜¼ìë„ í¸í•´ìš”</label> 
            </el-carousel-item>
          </el-carousel>
          <el-form-item label="í›„ê¸° ë“±ë¡">
            <el-input 
              v-model="form.review"
              placeholder="ê³ ê°ë‹˜ì˜ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì„¸ìš”. :)" 
              type="textarea"/>
          </el-form-item>
          <el-form-item>
            <UserImagePreview @child="setData"/>
          </el-form-item>
          <el-form-item label="ë¦¬ë·° ê³µê°œ">
            <el-radio-group v-model="form.status">
              <el-radio 
                label="true">
                ë™ì˜
              </el-radio>
              <el-radio 
                label="false">
                ë¹„ë™ì˜
              </el-radio>
            </el-radio-group>
          </el-form-item>
          <el-form-item>
            <el-button  
              type="default"
              class="btn-review"
              @click="sendReview()">ì €ì¥
            </el-button>
            <el-button @click="returnBoard()">ì·¨ì†Œ</el-button>
          </el-form-item>
        </el-form>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios'
import { mapState } from 'vuex'
import UserImagePreview from './UserImagePreview.vue';

export default {
  components: {
    UserImagePreview,
  },
  data() {
    return {
      files: [],
      keywords: [],
      form: {
        title: '',
        menu:'',
        review: '',
        status: '',
      }
    }
  },
  created() {
    this.$store.commit('food/getState')
  },
  computed: {
    ...mapState('food', ['foods']),
    
    setDataWatch() {
      return console.log(this.files)
    }
  },
  methods: {
    setData(e) {
      console.log(e);
      this.files = e
    },
    thisFilesCheck() {
      console.log("this.files", this.file)
    },
    returnBoard() {
      this.$router.push('/user/board');
    },
    sendReview() {
      console.log("keyword", this.keywords);
      // console.log("keywords", this.keywords.length);
      console.log("keywords test", this.keywords[0])
      
      let formData = new FormData(); 

      for(let j = 0; j < this.keywords.length; j++) {
        let keyword = this.keywords[j];
        console.log("keyword", keyword)
        formData.append("keyword", keyword);
      }
      for(let i = 0; i < this.files.length; i++) {
        let file = this.files[i].file;
        console.log("file test", file)
        formData.append("file", file);
      }
      formData.append("title", this.form.title);
      formData.append("menu", this.form.menu); 
      formData.append("ratings", this.form.ratings); 
      formData.append("review", this.form.review);
      formData.append("status", this.form.status);
      
      axios.post(`${process.env.VUE_APP_URL}/api/user/post/comment`, 
      formData, { 
        headers: {
          'Content-Type': 'multipart/form-data'
        },
      })      
      .then((res) => {
        console.log("ë°ì´í„° ì „ë‹¬ ì„±ê³µ", res);
        alert('ê³ ê°ë‹˜ì˜ ë¦¬ë·°ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.')
        this.$router.push('/user/board')
      })
      .catch((err) => {
        console.error("ì˜¤ë¥˜ ë°œìƒí•¨", err);
      });
    },
  }
};

</script>

<style lang="scss" scoped>
.container {
  padding: 0px 15px;
}

.btn-review {
  // margin-top: 10px;
  position: absolute;
  top: 0px;
  right: 10px;
  font-size: 0.8rem;
  color: white;
  background-color: rgba($color: #000000, $alpha: 0.8);
}

.img-box{
  border: solid;
}

p {
  margin: 10px 0px;
}

label {
  display:inline-block;
  text-align: center;
  height: 50px;
  width: 150px;
  background:rgb(248, 248, 248);
  border: 1px solid rgb(235, 233, 233);
  border-radius: .2rem;
  padding: 5px;
  box-shadow: 0 2px 2px -4px black;
  margin-right: 10px;
  margin-bottom: 10px;
}
input[id] {
  position: relative;
  top: 4px;
}
label[for] {
  position: relative;
  top: 20px;
}

input[type="checkbox"]:checked + label {
  background-color: rgba(171, 205, 236, 0.534);
}
input[type="checkbox"] {
  display: none;
}
input {
  width: 150px;
  font-size: 25px;
  text-align: center;
  box-shadow: 0 0 0 3px rgb(124, 175, 223);
  border-radius: 2px solid #ccc;
  box-shadow: 0 4px 4px -4px black;
  padding: 10px;
}
// input[id] {
//   position: relative; 
//   top: 50px;
// }
// label[for] {
//   position: relative;
//   top: 50px;
//   }
.el-carousel__item  {
  color: #475669;
  font-size: 15px;
  text-align: center;

  h3 {
    margin: 0px;
    padding: 0px;
  }
}

</style>